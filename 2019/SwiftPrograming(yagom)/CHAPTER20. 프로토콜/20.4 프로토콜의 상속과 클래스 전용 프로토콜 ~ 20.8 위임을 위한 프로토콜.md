# 20.4 프로토콜의 상속과 클래스 전용 프로토콜

프로토콜은 하나 이상의 프로토콜을 상속받아 기존 프로토콜의 요구사항보다 더 많은 요구사항을 추가할 수 있다. 프로토콜 상속 문법은 클래스의 상속 문법과 유사하다. 

프로토콜의 상속 리스트에 class 키워드를 추가해 프로토콜이 클래스 타입에만 채택될 수 있도록 제한할 수도 있다. 클래스 전용 프로토콜로 제한을 주기 위해서는 프로토콜의 상속 리스트의 맨 처음에 class 키워드가 위치해야 한다.



# 20.5 프로토콜 조합과 프로토콜 준수 확인

하나의 매개변수가 여러 프로토콜을 모두 준수하는 타입이어야 한다면 하나의 매개변수에 여러 프로토콜을 한 번에 조합하여 요구할 수 있다. 프로토콜을 조합하여 요구할 때는 SomeProtocol & AnotherProtocol과 같이 표현한다. 또, 하나의 매개변수가 프로토콜을 둘 이상 요구할 수도 있다. 이때도 마찬가지로 앰퍼샌드를 여러 프로토콜 이름 사이에 써주면 된다. 더불어 특정 클래스의 인스턴스 역할을 할 수 있는지 함께 확인할 수 있다. 구조체나 열거형 타입은 조합할 수 없다. 그리고 조합 중 클래스 타입은 한 타입만 조합할 수 있다. 

타입 캐스팅에 사용하던 is와 as 연산자를 통해 대상이 프로토콜을 준수하는지 확인할 수도 있고, 특정 프로토콜로 캐스팅 할 수 있다. 

- is 연산자를 통해 해당 인스턴스가 특정 프로토콜을 준수하는지 확인할 수 있다. 
- as? 다운캐스팅 연산자를 통해 다른 프로토콜로 다운 캐스팅을 시도해볼 수 있다.
- as! 다운캐스팅 연산자를 통해 다른 프로토콜로 강제 다운캐스팅을 할 수 있다.



# 20.6 프로토콜의 선택적 요구

프로토콜의 요구사항 중 일부를 선택적 요구사항으로 지정할 수 있다. 다만 먼저 고려해야 할 사항이 있다. 선택적 요구사항을 정의하고 싶은 프로토콜은 @objc 속성이 부여된 프로토콜이어야 한다. @objc 속성은 해당 프로토콜을 Objective-C 코드에서 사용할 수 있도록 만드는 역할을 한다. 그렇지만 해당 프로토콜을 Objective-C 코드와 공유하고 싶지 않더라도, 혹은 프로젝트를 Objective-C 코드와 공유하지 않더라도 @objc 속성이 부여되어야만 선택적 요구사항을 정의할 수 있다.

여기서 더 생각해보아야 할 것은 @objc 속성이 부여되는 프로토콜은 Objective-C 클래스를 상속받은 클래스에서만 채택할 수 있다는 것이다. 즉, 열거형이나 구조체 등에서는 @objc 속성이 부여된 프로토콜은 아예 채택할 수 없다. 

> Foundation 프레임워크
>
> > @objc 속성을 사용하려면 애플의 Foundation 프레임워크 모듈을 임포트해야 한다.

선택적 요구를 하면 프로토콜을 준수하는 타입에 해당 요구사항을 필수로 구현할 필요가 없다. 선택적 요구사항은 optional 식별자를 요구사항의 정의 앞에 붙여주면 된다. 만약 메서드나 프로퍼티를 선택적 요구사항으로 요구하게 되면 그 요구사항의 타입은 자동적으로 옵셔널이 된다. 

선택적 요구사항은 그 프로토콜을 준수하는 타입에 구현되어 있지 않을 수 있기 때문에 옵셔널 체이닝을 통해 호출할 수 있다. 프로퍼티뿐만 아니라 메서드도 마찬가지이다. 



# 20.7 프로토콜 변수와 상수

프로토콜 이름을 타입으로 갖는 변수 또는 상수에는 그 프로토콜을 준수하는 타입의 어떤 인스턴스라도 할당할 수 있다. 프로토콜은 프로토콜 이름만으로 자기 스스로 인스턴스를 생성하고 초기화할 수는 없다. 하지만 프로토콜 변수나 상수를 생성하여 특정 프로토콜을 준수하는 타입의 인스턴스를 할당할 수는 있다.



# 20.8 위임을 위한 프로토콜

**위임** : 클래스나 구조체가 자신의 책임이나 임무를 다른 타입의 인스턴스에게 위임하는 디자인 패턴이다.

책무를 위임하기 위해 정의한 프로토콜을 준수하는 타입은 자신에게 위임될 일정 책무를 할 수 있다는 것을 보장한다. 그렇기 때문에 다른 인스턴스에게 자신이 해야할 일을 믿고 맡길 수 있다. 위임은 사용자의 특정 행동에 반응하기 위해 사용되기도 하며, 비동기 처리에도 많이 사용한다.

**위임 패턴** : 애플의 프레임워크에서 사용하는 주요한 패턴 중 하나

애플의 프레임워크에서 중요하게 사용된다. 애플의 프레임워크에 사용하는 위임 패턴을 위해 다양한 프로토콜이 '0000Delegate'라는 식의 이름으로 정의되어 있다. 

예를들어 UITableView 타입의 인스턴스가 해야 하는 일을 위임받아 처리하는 인스턴스는 UITableViewDelegate 프로토콜을 준수하면 된다. 위임받은 인스턴스 즉, UITableViewDelegate 프로토콜을 준수하는 인스턴스는 UITableView의 인스턴스가 해야 하는 일을 대신 처리해줄 수 있다.